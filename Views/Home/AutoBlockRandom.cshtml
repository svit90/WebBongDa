@using Library;
@{
    ViewBag.Title = "AutoBlockRandom";

    Function fc = new Function();
}
@section csslib_head{
    <link href="https://system.immgroup.com/Content/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/fonts/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/css/animate.css" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/css/style.css" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/css/plugins/chosen/bootstrap-chosen.css" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Staatliches&display=swap" rel="stylesheet">
    <link href="https://system.immgroup.com/Content/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet">
}
<style>
    select.form-control:not([size]):not([multiple]) {
        height: 3.55rem !important;
    }

    .user-friends img {
        width: 60px !important;
        height: 60px !important;
    }

    .beginvs {
        min-height: 100px;
        max-height: 300px;
        overflow: scroll;
    }

    .endvs {
        min-height: 100px;
        max-height: 150px;
        overflow: scroll;
    }

    .list-group-item a {
        color: #3c3c3c;
    }

    .choose-flag {
        position: relative
    }

    .team-left, .team-right {
        position: absolute;
        top: -8px;
        left: 4px;
        color: #fb1b1b;
        font-weight: bold;
        padding: 0px 3px;
        font-size: 10px !important;
    }

    .tylekeo {
        color: #fb1b1b;
        font-size: 10px !important;
        font-weight: 700;
    }

    .team-right {
        left: 45px;
    }

    .endvs .team-left {
        left: 58px;
    }

    .endvs .team-right {
        left: 121px;
    }

    .bg-picked {
        background: #d2d2d2 !important;
    }

    .form-control {
        font-size: 1.4rem !important;
    }

    #ngaythidau, #ghichu {
        max-width: inherit;
    }

    .chosen-single {
        padding: 4px 10px !important;
        border-radius: 0 !important;
    }

    .fix-nation {
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: 'Righteous', cursive;
        background: #ffffffb3;
        border-radius: 15px;
        color: #000;
        padding: 15px;
    }

    .flag-card img {
        border-radius: 0%;
        border: 5px solid transparent;
        width: 150px;
        transition-duration: 0.1s;
    }

        .flag-card img:hover {
            cursor: pointer;
            transform: scale(1.1);
            transition: all ease 500ms;
        }

    .number-nation {
        font-size: 7rem;
        padding: 20px;
        position: relative;
    }

        .number-nation span {
            content: "";
            position: absolute;
            top: 20px;
            left: 50%;
            font-size: 12px;
            transform: translate(-50%);
        }

    .fix-center {
        padding-top: 10rem;
    }

    .add-vs {
        position: fixed;
        top: -2px;
        left: 0;
        z-index: 1;
    }

    .navbar-fixed-top {
        z-index: 10;
    }

    .display-0 {
        display: none;
    }

    .ibox-title, .ibox-content {
        background-color: #4e4e4e99 !important;
        border-color: #4e4e4e99 !important;
        color: #fff !important;
    }

    .tdhover:hover {
        background: #ffffff75;
        color: #161515 !important;
    }

    .tdhover {
        border-bottom: 1px #ccc solid !important;
        border-top: 0 !important;
    }

    @@media (min-width: 576px) and (max-width: 640px) {
        .fix-center {
            padding-top: 2rem;
        }

        .flag-card img {
            width: 45px;
        }

        .number-nation {
            font-size: 2rem;
            padding: 5px;
            margin-top: 10px;
        }

            .number-nation span {
                font-size: 10px;
                top: -11px;
            }
    }

    @@media (max-width: 575.98px) {
        .fix-center {
            padding-top: 2rem;
        }

        .flag-card img {
            width: 58px;
        }

        .number-nation {
            font-size: 2rem;
            padding: 5px;
            margin-top: 10px;
        }

            .number-nation span {
                font-size: 10px;
                top: -11px;
            }

        .fbold {
            font-weight: 500 !important;
            font-size: 15px;
        }

        .fix-nation {
            padding: 0
        }

        .gray-bg {
            background-repeat: repeat !important;
        }

        .user-friends img {
            width: 30px !important;
            height: 30px !important;
        }

        #totaltienB img, #totaltienA img {
            width: 15px;
        }
    }
</style>
<h2>AutoBlockRandom</h2>

<div class="row mt-5" style="max-height:600px;">

    <div class="col-md-6 offset-md-3">
        <div class="ibox ">
            <div class="ibox-title text-center">
                <h5>Giải Bóng đá Vô địch Thế giới Qatar 2022</h5>
            </div>
            <div class="ibox-content">

                <div class="panel blank-panel">
                    <div class="panel-heading">
                        <div class="panel-options">
                            <ul class="nav nav-tabs">
                                <li><a class="nav-link active" href="#tab-1" data-toggle="tab">Sắp diễn ra</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="panel-body">

                        <div class="tab-pane active" id="tab-1">
                            @foreach (var m in ViewBag.MatchNext)
                            {
                                <label id="ngays" name="ngays" class="form-control text-dark">@m.MTCH_DATE</label>
                                <label id="gios" name="gios" class="form-control text-dark">@m.MTCH_HH</label>
                                <label id="phuts" name="phuts" class="form-control text-dark">@m.MTCH_MM</label>
                                <label id="rteam1" name="rteam1" class="form-control text-dark">@m.idTeam1</label>
                                <label id="rteam2" name="rteam2" class="form-control text-dark">@m.idTeam2</label>
                            }
                            <label id="timematch" name="timematch" class="form-control text-dark">@ViewBag.MatchTime</label>
                            <label id="curmatch" name="curmatch" class="form-control text-dark">@ViewBag.Current</label>
                            <div class="col-12"><label class="countdownauto"></label></div>
                            <div class="table-responsive">
                                <table class="table table-striped table-assessment">
                                    <tbody>
                                        @foreach (var m in ViewBag.MatchNext)
                                        {
                                            string flagi1 = @m.flagTeam1 + ".png";
                                            string flagi2 = @m.flagTeam2 + ".png";
                                            string flagticked = fc.CheckPicked(@m.MTCH_ID);
                                            <tr>
                                                <td class="tdhover">
                                                    <a href="/tools/autorandom/@m.MTCH_ID" class="text-white">
                                                        <div class="row">
                                                            <div class="col-12 text-center" style="border-left: 0px #ccc solid;">
                                                                <small>Lúc @m.MTCH_HH:@m.MTCH_MM ngày @m.MTCH_DATE</small>
                                                            </div>
                                                            <div class="col-5 p-0">
                                                                <div class="row">
                                                                    <div class="col-12 text-right">
                                                                        <span class="tylekeo display-@m.KEO_1">+ @m.KEO_1</span>
                                                                        @m.nameTeam1
                                                                        <img title="@m.nameTeam1" src="~/Content/img/flags/32/@flagi1" alt="flag">

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-2 text-center p-0">
                                                                @m.TYSO_1 - @m.TYSO_2
                                                            </div>
                                                            <div class="col-5 p-0">
                                                                <div class="row">
                                                                    <div class="col-12 text-left">
                                                                        <img title="@m.nameTeam2" src="~/Content/img/flags/32/@flagi2" alt="flag"> @m.nameTeam2
                                                                        <span class="tylekeo display-@m.KEO_2">+ @m.KEO_2</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </a>

                                                </td>
                                            </tr>

                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>

                </div>

            </div>

        </div>
    </div>
</div>
@section jslib_footer {

    <script src="https://system.immgroup.com/Scripts/jquery-3.1.1.min.js"></script>
    <script src="https://system.immgroup.com/Scripts/popper.min.js"></script>
    <script src="https://system.immgroup.com/Scripts/bootstrap.js"></script>
    <script src="https://system.immgroup.com/Scripts/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="https://system.immgroup.com/Scripts/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <script src="https://system.immgroup.com/Scripts/plugins/chosen/chosen.jquery.js"></script>
    <script src="https://system.immgroup.com/Scripts/plugins/validate/jquery.validate.min.js"></script>
    <script src="https://system.immgroup.com/Scripts/plugins/datapicker/bootstrap-datepicker.js"></script>
    <script>
        $(document).ready(function () {
            var endTime = $("#timematch").text();
            countdowntime(endTime,"countdownauto");

        });

        function countdowntime(_time, _class) {
            var countDownDate = new Date(_time);
            // Update the count down every 1 second
            var x = setInterval(function () {
                // Get today's date and time
                var now = new Date().getTime();
                // Find the distance between now and the count down date
                var distance = countDownDate - now;
                // Time calculations for days, hours, minutes and seconds
                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                // Output the result in an element with id="demo"
                $("." + _class).text(days + "d " + hours + "h "
                    + minutes + "m " + seconds + "s ");

                // If the count down is over, write some text
                if (distance < 0) {
                    var _m = $("#curmatch").text();
                    var _t1 = $("#rteam1").text();
                    var _t2 = $("#rteam2").text();
                    clearInterval(x);
                    $("." + _class).text("EXPIRED");
                    AutoKhoacuoc(_m, _t1, _t2);
                }
            }, 1000);
        }

        function AutoKhoacuoc(matchId, _team1, _team2) {
            var form = new FormData();
            form.append("_mtchid", matchId);
            form.append("_team1", _team1);
            form.append("_team2", _team2);
            //AJAX REQUEST
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/tools/autorandom-submit/" + matchId, true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var res = xhr.responseText;
                    var j_res = JSON.parse(res);
                    if (j_res.type === "success") {
                        window.location.href = j_res.url;
                    }
                    else {
                        swal({ title: j_res.header, text: j_res.mess, type: j_res.type });
                    }

                }
            };
            xhr.send(form);
        }
    </script>>
}